\documentclass[12pt,a4paper,oneside]{ctexbook}
\usepackage[left=2cm, right=2cm, top=3cm, bottom=3cm]{geometry}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage[colorlinks=true, linkcolor=black, citecolor=black]{hyperref}

\theoremstyle{definition}
\theoremstyle{remark}
\newtheorem*{solution}{解析} 

\usepackage{pdfpages}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage[colorlinks=true, linkcolor=black, citecolor=black]{hyperref}

\setCJKmainfont{fonts/Songti.ttf}
\setCJKsansfont{fonts/Heiti.ttf}
\usepackage{unicode-math}
\setmathfont{NewComputerModernMath} 

\usepackage{pdfpages}

\usepackage{tikz}
\usetikzlibrary{positioning, calc, shapes.geometric} 

\usepackage{tasks}
\usepackage{xparse}
\usepackage[most]{tcolorbox}
\tcbuselibrary{skins, breakable}

\settasks{
	label = \Alph*.,          
	label-width = 1.8em,     
	item-indent = 2.3em,    
	label-offset = 0.5em,   
	column-sep=2em           
}

\newcounter{choicecounter}

\newcommand{\knowledgepointicon}{
	\tikz[baseline=-0.1ex] \node[
	fill=blue!60!cyan,
	shape=diamond,
	aspect=0.7,
	inner sep=1.5pt
	] {};
}

\NewDocumentEnvironment{choice}{m m}{
	\par\addvspace{\medskipamount}
	\stepcounter{choicecounter}
	\begin{tcolorbox}[
		enhanced,
		breakable, 
		frame hidden, 
		borderline west={1.5pt}{0pt}{teal}, 
		colback=white, 
		left=4mm, 
		right=2mm,
		top=2pt,
		bottom=2pt,
		boxsep=0pt, 
		before upper={
			\noindent 
			\textbf{\color{teal}习题 \arabic{choicecounter}} 
			\hfill 
			\knowledgepointicon~\text{#2} \quad 
			{\color{teal!70!blue}[\ \textbf{#1}\ ]} 
			\par\vspace{1ex}
		}
		]
	}{
	\end{tcolorbox}
}

\usepackage{xparse} 

\NewDocumentEnvironment{exercise}{ >{\SplitArgument{1}{}} O{} m m }{
	
}{\relax} % 先定义一个空的，防止报错

\RenewDocumentEnvironment{exercise}{ O{} g g }{% O{}=>[note], g=>{score}, g=>{topic}
	\par\addvspace{\medskipamount}
	\stepcounter{choicecounter}
	\begin{tcolorbox}[
		enhanced, breakable, frame hidden,
		borderline west={1.5pt}{0pt}{teal},
		colback=white,
		left=4mm, right=2mm, top=2pt, bottom=2pt, boxsep=0pt,
		fonttitle=\bfseries,
		% 标题
		title={
			\color{teal}题目 \thechoicecounter % 始终显示题目编号
			% 如果第一个可选参数 (补充说明) 存在, 则显示它
			\IfValueT{#1}{\ (#1)}
			% 如果第二个参数 (分数) 存在, 则显示它
			\IfValueT{#2}{\ (本题 #2 分)}%
			\hfill % 
			% 如果第三个参数 (考点) 存在, 则显示它
			\IfValueT{#3}{\knowledgepointicon~\textcolor{black}{#3}}
		}
		]
	}{
	\end{tcolorbox}
}

\renewenvironment{solution}{
	\par\addvspace{\medskipamount}
	\begin{tcolorbox}[
		enhanced, breakable,
		frame hidden, 
		borderline west={1.5pt}{0pt}{teal}, 
		colback=white, 
		left=4mm, right=2mm, top=2pt, bottom=2pt, boxsep=0pt,
		before upper={ 
			\noindent\textbf{\color{teal}解析}\par\vspace{0.5ex}
		}
		]
	}{
	\end{tcolorbox}
}

\newtcolorbox{note}[1][]{
	enhanced, breakable,
	frame hidden, 
	borderline west={1.5pt}{0pt}{orange}, 
	colback=white, 
	left=4mm, right=2mm, top=2pt, bottom=2pt, boxsep=0pt,
	before upper={ 
		\noindent\textbf{\color{orange}注}\par\vspace{0.5ex}
	},
	#1
}

\begin{document}
\includepdf[pages=1]{cover.pdf}

{ 
	\thispagestyle{empty} 
	\begin{titlepage}
		\thispagestyle{empty} 
		\begin{flushleft}
			\vspace*{2cm}
			
			{\large
				知乎@余命数 \\
				Midnight Forever
			}
			
			\vspace{4cm}
			
			{\fontsize{36}{44}\selectfont\bfseries 高中数学之旅（习题集）}\\[2cm]

			{\fontsize{22}{28}\selectfont An Excursion through Secondary School Mathematics: Exercise Book}

			\vspace{2cm}

			\vfill

			{\small
				最后更新: \today \\
				书稿版本，禁止修改、倒卖等任何侵犯作者著作权的行为.
			}
		\end{flushleft}
	\end{titlepage}
}

\pagenumbering{roman}
	
	\frontmatter
	\pagestyle{plain}
	\tableofcontents
	
	\mainmatter
	\include{chapter/集合.tex}
	\include{chapter/解三角形.tex}
	
	\chapter{参考答案}
	\include{solution/集合.tex}
	\include{solution/解三角形.tex}
	

\includepdf[pages=2]{cover.pdf}
\end{document}